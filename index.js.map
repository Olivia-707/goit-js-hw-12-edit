{"version":3,"file":"index.js","sources":["../src/js/render-functions.js","../src/js/pixabay-api.js","../src/main.js"],"sourcesContent":["export const createGalleryCardTemplate = imgInfo => {\n  return `\n    <li class=\"gallery-card\">\n      <a class=\"gallery-link\" href=\"${imgInfo.largeImageURL}\">\n        <img class=\"gallery-img\" src=\"${imgInfo.webformatURL}\" alt=\"${imgInfo.tags}\" />\n      </a>\n      <ul class=\"text-info\">\n        <li class=\"image-info\">\n          <h4>Likes</h4>\n          <p>${imgInfo.likes}</p>\n        </li>\n        <li class=\"image-info\">\n          <h4>Views</h4>\n          <p>${imgInfo.views}</p>\n        </li>\n        <li class=\"image-info\">\n          <h4>Comments</h4>\n          <p>${imgInfo.comments}</p>\n        </li>\n        <li class=\"image-info\">\n          <h4>Downloads</h4>\n          <p>${imgInfo.downloads}</p>\n        </li>\n      </ul>\n    </li>\n  `;\n};\n","import axios from 'axios';\n\nexport const fetchPhotosByQuery = (searchedEl, currentPage) => {\n  const searchParams = new URLSearchParams({\n    q: searchedEl,\n    key: '48488586-a0a2593ae7f5d81beed47469e',\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n    page: currentPage,\n    per_page: 15,\n  });\n  return axios.get(`https://pixabay.com/api/?${searchParams}`);\n};\n","import iziToast from 'izitoast';\nimport SimpleLightbox from 'simplelightbox';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport { createGalleryCardTemplate } from './js/render-functions';\nimport { fetchPhotosByQuery } from './js/pixabay-api';\n\nconst searchFormEl = document.querySelector('.js-search-form');\nconst galleryEl = document.querySelector('.js-gallery');\nconst loader = document.querySelector('.loader');\nconst loadBtn = document.querySelector('.js-load-btn');\n\nlet page = 1;\nlet searchedQuery = '';\nlet perPage = 15;\nlet totalHits = 0;\n\nloadBtn.classList.add('is-hidden');\n\nconst lightbox = new SimpleLightbox('.js-gallery a', {\n  captionDelay: 300,\n  captionsData: 'alt',\n});\n\nconst onSearchFormSubmit = async event => {\n  try {\n    event.preventDefault();\n\n    searchedQuery = searchFormEl.elements[0].value.trim();\n\n    if (searchedQuery === '') {\n      iziToast.error({\n        message: 'Plese enter your request',\n        position: 'topRight',\n      });\n      return;\n    }\n\n    page = 1;\n    loadBtn.classList.add('is-hidden');\n    loader.classList.add('show-loader');\n\n    const { data } = await fetchPhotosByQuery(searchedQuery, page);\n    totalHits = data.totalHits;\n\n    if (data.total === 0) {\n      iziToast.error({\n        message:\n          'Sorry, there are no images matching your searh query. Please try again!',\n        position: 'topRight',\n      });\n\n      galleryEl.innerHTML = '';\n      searchFormEl.reset();\n\n      return;\n    }\n\n    if (data.totalHits > 1) {\n      loadBtn.classList.remove('is-hidden');\n      loadBtn.addEventListener('click', onLoadMoreBtn);\n    }\n\n    const galleryTemplate = data.hits\n      .map(el => createGalleryCardTemplate(el))\n      .join('');\n\n    galleryEl.innerHTML = galleryTemplate;\n    lightbox.refresh();\n  } catch (err) {\n    console.log(err);\n  } finally {\n    loader.classList.remove('show-loader');\n  }\n};\n\nsearchFormEl.addEventListener('submit', onSearchFormSubmit);\n\nconst onLoadMoreBtn = async () => {\n  try {\n    setTimeout(() => {\n      loader.classList.remove('show-loader');\n    }, 500);\n    loader.classList.add('show-loader');\n    page++;\n\n    const { data } = await fetchPhotosByQuery(searchedQuery, page);\n\n    const galleryTemplate = data.hits\n      .map(el => createGalleryCardTemplate(el))\n      .join('');\n    galleryEl.insertAdjacentHTML('beforeend', galleryTemplate);\n    lightbox.refresh();\n    loader.classList.remove('show-loader');\n\n    const imgBox = document\n      .querySelector('.gallery-card')\n      .getBoundingClientRect();\n    let imgHeight = imgBox.height;\n\n    window.scrollBy({\n      top: imgHeight * 2,\n      behavior: 'smooth',\n    });\n\n    if (page * perPage >= totalHits) {\n      loadBtn.classList.add('is-hidden');\n      iziToast.info({\n        message: \"We're sorry, but you're reached the end of search results.\",\n        position: 'topRight',\n      });\n\n      if (!loadBtn.classList.contains('is-hidden')) {\n        loadBtn.removeEventListener('click', onLoadMoreBtn);\n      }\n    }\n  } catch (err) {\n    console.log(err);\n  }\n};\n"],"names":["createGalleryCardTemplate","imgInfo","fetchPhotosByQuery","searchedEl","currentPage","searchParams","axios","searchFormEl","galleryEl","loader","loadBtn","page","searchedQuery","perPage","totalHits","lightbox","SimpleLightbox","onSearchFormSubmit","event","iziToast","data","onLoadMoreBtn","galleryTemplate","el","err","imgHeight"],"mappings":"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"}